{"id":"slop-5yt","title":"Sonnet not viable for /rest integration test — session discovery failure","description":"Sonnet (claude-sonnet-4-5) fails 80% of the time (4/5 runs) when running the /rest integration test. It consistently finds only its own active session instead of discovering the 3 fixture sessions in ~/.claude/projects/-{encoded-path}/.\n\nRoot cause: The session discovery step requires enumerating all JSONL files in the projects directory. Sonnet latches onto its own running session file (the most recent) and stops looking, while Opus reliably finds all files and filters appropriately.\n\nFailure modes observed:\n- 3/5 runs: Analyzed its own session as a 'meta-analysis bootstrap' (1 session report instead of 3)\n- 1/5 runs: Recognized the self-referential situation and refused to proceed, asking user for options\n- 1/5 runs: Correctly found all 3 fixtures (nondeterministic success)\n\nCost comparison:\n- Opus: $7.55/run, 100% success (1/1)\n- Sonnet: $0.60-1.14/run, 20% success (1/5)\n- Effective Sonnet cost to get one correct result: ~$5.55 (comparable to Opus)\n\nIf we can fix the prompt or discovery mechanism to guide Sonnet reliably, it would be 5-8x cheaper per run. The issue is in how the /rest skill prompt and the fatigue_check/inventory scripts present session data to the model — Sonnet needs more explicit guidance about what to look for.\n\nData: plugins/claude-rest-system/test/integration/results/ contains all 5 Sonnet run artifacts plus the Opus baseline.","status":"open","priority":2,"issue_type":"bug","owner":"git@yaakovnemoy.com","created_at":"2026-02-12T20:35:29.09723-08:00","created_by":"Yaakov M Nemoy","updated_at":"2026-02-12T20:36:28.536549-08:00","labels":["cost-optimization","integration-test","rest","sonnet"]}
